#!/usr/local/bin/python
# -*- coding: UTF-8 -*-

import os, string, glob, io, pycorpora
from types import *

import pqf_subs, da_subs, annals_subs, rev_subs


VERBOSE = 0
#uncomment to see info on which files are being processed etc
#VERBOSE = 1

def modify_section(text, file):

    #text = text.encode("utf-8")
    text = u"%s" % text

    #GOT AS FAR AS: '2019_03_29.txt'
    #SECOND BATCH (first batch not complete):
    #GOT AS FAR AS: '2017_08_04.txt'

    known_places = [
                    "Abbey Wood",
                    "Aberaeron",
                    "Aberdeen",
                    "Abergavenny, Monmouthshire, Wales",
                    "Abergavenny, Monmouthshire",
                    "Abergavenny",
                    "Aberystwyth",
                    "Aldeburgh",
                    "Alderley Edge",
                    "Altrincham",
                    "Archway",
                    "Arundel",
                    "Ashford",
                    "Ashton-under-Lyne",
                    "Ashton",
                    "Bangor, County Down",
                    "Bangor",
                    "Barking",
                    "Barnham",
                    "Barnoldby-Le-Beck",
                    "Barnsbury",
                    "Barrow",
                    "Barton-upon-Humber",
                    "Belfast",
                    "Bembridge",
                    "Bermondsey, south-east London",
                    "Bermondsey",
                    "Berrow",
                    "Beverley, east Yorkshire",
                    "Beverley",
                    "Birkenhead",
                    "Birmingham",
                    "Blackburn",
                    "Blackpool",
                    "Bognor Regis, West Sussex",
                    "Bognor Regis",
                    "Bognor",
                    "Bolton",
                    "Bosham",
                    "Bournemouth",
                    "Bradford",
                    "Brecon, Powys",
                    "Brecon",
                    "Brent Cross",
                    "Bridlington",
                    "Brighton, East Sussex",
                    "Brighton",
                    "Bristol",
                    "Brixton",
                    "Brunstane",
                    "Builth Wells",
                    "Burnley",
                    "Bury St Edmunds",
                    "Bury",
                    "Buxton, Derbyshire",
                    "Buxton",
                    "Callander and the Trossachs",
                    "Callander",
                    "Cambridge",
                    "Canada Water",
                    "Canterbury",
                    "Cardiff",
                    "Cardigan, Ceredigion",
                    "Cardigan",
                    "Carlisle",
                    "Carmarthen",
                    "Carnforth",
                    "Cartmel",
                    "Chelmsford",
                    "Cheltenham",
                    "Chester, Cheshire",
                    "Chester",
                    "Chichester, West Sussex",
                    "Chichester",
                    "Cilborth",
                    "City Thameslink",
                    "Clacton",
                    "Clapham",
                    "Cleethorpes",
                    "Colchester, Essex",
                    "Colchester",
                    "Coventry",
                    "Cowes",
                    "Crawley",
                    "Crewe",
                    "Crickhowell",
                    "Crouch End",
                    "Croydon, south London",
                    "Croydon",
                    "Cumbernauld",
                    "Dalmuir",
                    "Dalston",
                    "Dartmoor",
                    "Deal, Kent",
                    "Deal",
                    "Dedham Vale",
                    "Deepdene",
                    "Deptford, south-east London",
                    "Deptford",
                    "Derby",
                    "Didsbury",
                    "Doncaster",
                    "Dorking, Surrey",
                    "Dorking",
                    "Dover",
                    "Dundee",
                    "Dunnet Bay",
                    "Eastbourne, East Sussex",
                    "Eastbourne",
                    "Edinburgh Waverley",
                    "Edinburgh",
                    "Edmonton",
                    "Ely, Cambridgeshire",
                    "Ely",
                    "Epping Forest",
                    "Epsom",
                    "Essex",
                    "Exmouth",
                    "Exmouth",
                    "Falmouth",
                    "Faversham",
                    "Felixstowe",
                    "Finchley Road",
                    "Finnieston, Glasgow",
                    "Finnieston",
                    "Fishbourne",
                    "Fishguard",
                    "Folkestone",
                    "Forest Gate",
                    "Galashiels",
                    "Gatwick Airport",
                    "Gatwick",
                    "Gerrans Bay",
                    "Glasgow",
                    "Gloucester",
                    "Gobowen",
                    "Gorton",
                    "Gospel Oak, north London",
                    "Gospel Oak",
                    "Grange-over-Sands and Cartmel",
                    "Grange-Over-Sands, Cumbria",
                    "Grange-over-Sands",
                    "Grange",
                    "Great Limber",
                    "Great Malvern and the Malvern hills",
                    "Great Malvern",
                    "Grimsby and Cleethorpes, Lincolnshire",
                    "Grimsby",
                    "Guildford",
                    "Hackney",
                    "Halesworth",
                    "Halifax, West Yorkshire",
                    "Halifax",
                    "Hampstead",
                    "Harome",
                    "Harringay",
                    "Harrogate",
                    "Harwich",
                    "Hastings",
                    "Hay-on-Wye",
                    "Hay",
                    "Headcorn",
                    "Heathrow",
                    "Hebden Bridge, West Yorks",
                    "Hebden Bridge",
                    "Hebden Bridge",
                    "Helmsley, North Yorkshire",
                    "Helmsley",
                    "Hemel Hempstead, Hertfordshire",
                    "Hemel Hempstead",
                    "Hemel",
                    "Hereford",
                    "Hertford, Hertfordshire",
                    "Hertford",
                    "Hertford",
                    "Heswall",
                    "Highbury & Islington",
                    "Highbury and Islington",
                    "Highgate Hill",
                    "Highgate",
                    "Hornsea",
                    "Hornsey, north London",
                    "Hornsey",
                    "Hornsey",
                    "Horsham",
                    "Hove",
                    "Huddersfield",
                    "Hull",
                    "Hull",
                    "Inverness",
                    "Ipswich, Suffolk",
                    "Ipswich",
                    "Joppa",
                    "Kendal, Cumbria",
                    "Kendal",
                    "Kensington",
                    "King's Cross, London",
                    "King's Cross",
                    "King's Lynn",
                    "Kirkwall",
                    "Knaresborough",
                    "Knutsford",
                    "Lampeter, Ceredigion",
                    "Lampeter",
                    "Lancaster, Lancashire",
                    "Lancaster",
                    "Lavant",
                    "Leamington",
                    "Leatherhead",
                    "Leeds",
                    "Leicester",
                    "Leuchars",
                    "Lewes, East Sussex",
                    "Lewes",
                    "Lewes",
                    "Lewes",
                    "Lewisham",
                    "Leyton",
                    "Leytonstone",
                    "Lichfield, Staffordshire",
                    "Lichfield",
                    "Lincoln",
                    "Littlehampton, West Sussex",
                    "Littlehampton",
                    "Liverpool Lime Street",
                    "Liverpool Street",
                    "Liverpool",
                    "Llandovery",
                    "Llandrindod Wells",
                    "London Bridge",
                    "London Euston",
                    "London Moorgate",
                    "London St Pancras",
                    "London Victoria",
                    "London",
                    "Loughborough",
                    "Louth, Lincolnshire",
                    "Louth",
                    "Lowestoft",
                    "Lowestoft",
                    "Lybster",
                    "Mablethorpe",
                    "Malton",
                    "Malvern and the hills",
                    "Manchester Piccadilly",
                    "Manchester",
                    "Margate",
                    "Maryland",
                    "Merthyr",
                    "Mickleham",
                    "Midhurst",
                    "Milngavie",
                    "Milton Keynes",
                    "Monmouth",
                    "Moorgate",
                    "Morecambe",
                    "Motherwell",
                    "Musselburgh",
                    "Muswell Hill",
                    "New Ash Green, Kent",
                    "New Ash Green",
                    "New Cross",
                    "New Quay",
                    "Newcastle upon Tyne",
                    "Newcastle",
                    "Newcastle",
                    "Newcastle",
                    "Newland",
                    "Newport",
                    "Norbury",
                    "North Berwick",
                    "Northallerton",
                    "Northampton",
                    "Northumberland",
                    "Norwich",
                    "Notting Hill",
                    "Nottingham",
                    "Nuneaton",
                    "Openshaw, Manchester",
                    "Openshaw",
                    "Ormeau, Belfast",
                    "Ormeau",
                    "Oswestry, Shropshire",
                    "Oswestry",
                    "Ouseburn, Newcastle upon Tyne",
                    "Ouseburn",
                    "Oxenholme",
                    "Oxford",
                    "Oxton",
                    "Paddington",
                    "Peckham",
                    "Penzance",
                    "Perth",
                    "Peterborough",
                    "Pimlico",
                    "Plymouth",
                    "Poole",
                    "Portobello, Edinburgh",
                    "Portobello",
                    "Portsmouth",
                    "Potters Bar",
                    "Preston",
                    "Ramsbottom, Greater Manchester",
                    "Ramsbottom",
                    "Ramsgate",
                    "Richmond",
                    "Ripon, North Yorkshire",
                    "Ripon",
                    "Rochdale",
                    "Rochester",
                    "Rossendale",
                    "Rotherhithe",
                    "Ryde and Newport",
                    "Ryde",
                    "Scarborough",
                    "Scawton",
                    "Scrabster",
                    "Selsey",
                    "Shanklin",
                    "Sheffield",
                    "Shrewsbury",
                    "Somers Town",
                    "Southampton",
                    "Southwark",
                    "Southwold, Suffolk",
                    "Southwold",
                    "Spalding, Lincolnshire",
                    "Spalding",
                    "St Albans",
                    "St Austell",
                    "St Helens",
                    "St Ives",
                    "St Pancras",
                    "Stansted",
                    "Steephill Cove",
                    "Stevenage",
                    "Stirling",
                    "Stockport, Greater Manchester",
                    "Stockport",
                    "Stoke",
                    "Stowmarket",
                    "Stratford",
                    "Stroud, Gloucestershire",
                    "Stroud",
                    "Surrey Quays, London",
                    "Surrey Quays",
                    "Swansea",
                    "Swindon",
                    "Tangmere",
                    "Taunton",
                    "Tenterden, Kent",
                    "Tenterden",
                    "Thirsk",
                    "Thornhill",
                    "Thornton Hough",
                    "Thurso and Dunnet Bay, Caithness",
                    "Thurso and Dunnet Bay",
                    "Thurso",
                    "Topsham",
                    "Totnes",
                    "Tottenham Hale",
                    "Tottenham",
                    "Truro, Cornwall",
                    "Truro",
                    "Tunbridge Wells",
                    "Tynemouth",
                    "Ulverston",
                    "Ventnor, Isle of Wight",
                    "Ventnor",
                    "Walthamstow",
                    "Walton-On-The-Naze",
                    "Warrington, Cheshire",
                    "Warrington",
                    "Waterloo",
                    "Watford",
                    "Welland",
                    "West Ashling",
                    "West Dean",
                    "west Didsbury, south Manchester",
                    "west Didsbury",
                    "West Kirby, Merseyside",
                    "West Kirby",
                    "West Wittering",
                    "Weston-super-Mare, Somerset",
                    "Weston-super-Mare",
                    "Whitechapel",
                    "Whitley Bay, Tyne and Wear",
                    "Whitley Bay",
                    "Whitstable, Kent",
                    "Whitstable",
                    "Wick",
                    "Willesden",
                    "Wilmslow",
                    "Wimborne Minster, Dorset",
                    "Wimborne Minster",
                    "Wimborne",
                    "Windermere",
                    "Wittering",
                    "Woking",
                    "Wood Green",
                    "Woolwich",
                    "Worcester",
                    "Wrexham",
                    "Wrexham",
                    "Yeovil",
                    "York",
                    #"Shoreditch",
                    "Durham",

                    "Tottenham Court Road tube",
                    "Newport I.W",
                    "Romford, east London",
                    "Romford",
                    "Gidea Park",
                    "Heathrow",
                    "Reading",
                    "Hornchurch",
                    "Upminster",
                    "Bexhill-on-Sea, East Sussex",
                    "Bexhill-on-Sea",
                    "Bexhill",
                    "Rye",
                    "Battle",
                    "Pwllheli",
                    "Porthmadog",
                    "Machynlleth",
                    "Aberdaron",
                    "Porthmadog",
                    "Caernarfon",
                    "Harlech",
                    "Kelso, Roxburghshire",
                    "Kelso",
                    "Berwick-upon-Tweed",
                    "Jedburgh",
                    "Hawick",
                    "Melrose",
                    "Galashiels",
                    "Coldstream",
                    "Berwick",
                    "Whitby, North Yorkshire",
                    "Whitby",
                    "Middlesbrough",
                    "Beaumaris",
                    "Euston",
                    "Pentonville",
                    "Holyhead",
                    "Worcester",
                    "Leominster",
                    "Ludlow",
                    "Shrewsbury",
                    "Abergavenny",
                    "Cardiff",
                    "Stamford, Lincolnshire",
                    "Stamford",
                    "Exeter",
                    "Peterborough",
                    "Grantham",
                    "Leicester",
                    "Cambridge",
                    "Nottingham",
                    "Frome, Somerset",
                    "Frome",
                    "Yeovil",
                    "Bath",
                    "Bristol",
                    "St Leonards-on-Sea, East Sussex",
                    "St Leonards-on-Sea",
                    "St Leonards",
                    "Sevenoaks",
                    "Kew",
                    "Twickenham",
                    "Overstrand",
                    "Windsor & Eton, Berkshire",
                    "Windsor & Eton",
                    "Windsor",
                    "Eton",
                    "Slough",
                    "Staines",
                    "Richmond",
                    "Oakley Green",
                    "Datchet",
                    "Scunthorpe",
                    "Retford",
                    "Newark",
                    "Nottingham",
                    "Sheffield",
                    "Markham Moor",
                    "Berwick-upon-Tweed, Northumberland",
                    "Berwick-upon-Tweed",
                    "Berwick",
                    "Dollis Hill, north-west London",
                    "Dollis Hill",
                    "Willesden",
                    "Cricklewood",
                    "Kensal Rise",
                    "Arundel, West Sussex",
                    "Arundel",
                    "Littlehampton",
                    "Climping",
                    "Barnham",
                    "Boscastle, Cornwall",
                    "Boscastle",
                    "Penge",
                    "Lesnewth",
                    "Camelford",
                    "Launceston",
                    "Bodmin",
                    "Padstow",
                    "Tintagel",
                    "Kintyre peninsula, Argyll and Bute",
                    "Kintyre",
                    "Argyll and Bute",
                    "Argyll",
                    "Bute",
                    "the Isle of Arran",
                    "Campbeltown",
                    "Arran",
                    "Tarbert",
                    "Westport",
                    "Machrihanish",
                    "Diss, Norfolk",
                    "Diss",
                    "Burston",
                    "Kingston upon Hull, Yorkshire",
                    "Kingston upon Hull",
                    "Rochester, Kent",
                    "Rochester",
                    "Chatham",
                    "Gillingham",
                    "Strood",
                    "Maidstone",
                    "Preston, Lancashire",
                    "Preston",
                    "Wigan",
                    "Herne Bay, Kent",
                    "Herne Bay",
                    "Sittingbourne",
                    "Winchester, Hampshire",
                    "Winchester",
                    "Basingstoke",
                    "Stanmore",
                    "Weeke",
                    "Brentford, west London",
                    "Brentford",
                    "Putney",
                    "Northfields",
                    "South Ealing",
                    "Boston Manor",
                    "Stirling, Edinburgh",
                    "Stirling",
                    "Cromer, Norfolk",
                    "Cromer",
                    "Overstrand",
                    "Runton",
                    "Bedford",
                    "Luton",
                    "Wellingborough",
                    "Kettering",
                    "Milton Keynes",
                    "Clitheroe, Lancashire",
                    "Clitheroe",
                    "Blackburn",
                    "Bolton",
                    "Whalley",
                    "Langho",
                    #"Anglesey/Ynys Môn, Wales",    # THESE CAUSE UNICODE ERRORS :(
                    #"Anglesey/Ynys Môn",           # THESE CAUSE UNICODE ERRORS :(
                    "Anglesey/Ynys Mon, Wales",
                    "Anglesey/Ynys Mon",
                    "Anglesey",
                    #"Ynys Môn",                    # THESE CAUSE UNICODE ERRORS :(
                    "Ynys Mon",
                    "Wylfa",
                    "Valley",
                    "Llangefni",
                    "Sherborne, Dorset",
                    "Sherborne",
                    ### known_places (AUTO-GENERATED) ###
                    "Plumstead, south-east London",
                    "Plumstead",
                    "Abingdon, Oxfordshire",
                    "Abingdon",
                    "Monmouth and the lower Wye valley",
                    "Monmouth",
                    "Okehampton, Devon",
                    "Okehampton",
                    "Lanark",
                    "Lowestoft, Suffolk",
                    "Lowestoft",
                    "Saltaire",
                    "Bowness and Windermere",
                    "Bowness",
                    "Windermere",
                    "Luton, Bedfordshire",
                    "Luton",
                    "Lambeth, London",
                    "Lambeth",
                    "Aberaeron, Ceredigion",
                    "Aberaeron",
                    "Canterbury, Kent",
                    "Canterbury",
                    "Perth, Perthshire",
                    "Perth",
                    "Hotwells, Bristol",
                    "Hotwells",
                    "Worthing, West Sussex",
                    "Worthing",
                    "Ottery St Mary, Devon",
                    "Ottery St Mary",
                    "Stranraer and the Rhinns, Dumfries and Galloway",
                    "Stranraer and the Rhinns",
                    "Stranraer",
                    "the Rhinns",
                    "Harringay, north London",
                    "Harringay",
                    "St Albans",
                    "St Albans",
                    "Rye, East Sussex",
                    "Rye",
                    "Dover, Kent",
                    "Dover",
                    "Fishguard and Newport, Pembrokeshire",
                    "Fishguard and Newport",
                    "Fishguard",
                    "Newport",
                    "County Durham",
                    "Streatham, south-west London",
                    "Streatham",
                    "Scarborough, North Yorkshire",
                    "Scarborough",
                    "Newport, Isle of Wight",
                    "Newport",
                    "Ashbourne, Derbyshire",
                    "Ashbourne",
                    "Kirkwall and Orkney",
                    "Kirkwall",
                    "Orkney",
                    "Bishop's Castle, Shropshire",
                    "Bishop's Castle",
                    "the Torridge valley, Devon",
                    "the Torridge valley",
                    "Hither Green, London",
                    "Hither Green",
                    "Rhayader & the Elan valley, Powys",
                    "Rhayader & the Elan valley",
                    "Rhayader",
                    "the Elan valley",
                    "Petworth and Pulborough, West Sussex",
                    "Petworth and Pulborough",
                    "Petworth",
                    "Pulborough",
                    "Framplington, Suffolk",
                    "Framplington",
                    "Kirkcaldy, Fife",
                    "Kirkcaldy",
                    "Crediton, Devon",
                    "Crediton",
                    "the Isle of Portland, Dorset",
                    "the Isle of Portland",
                    "Blaenafon, Gwent",
                    "Blaenafon",
                    "Thetford, Norfolk",
                    "Thetford",
                    "Rothbury, Northumberland",
                    "Rothbury",
                    "Ilford, east London",
                    "Ilford",
                    "Dorchester-on-Thames, Oxfordshire",
                    "Dorchester-on-Thames",
                    "Beaconsfield, Bucks",
                    "Beaconsfield",
                    "Helensburgh, Argyll & Bute",
                    "Helensburgh",
                    "Cambridge",
                    "Cambridge",
                    "Aylsham, Norfolk",
                    "Aylsham",
                    "Hove, East Sussex",
                    "Hove",
                    "Ballycastle, County Antrim",
                    "Ballycastle",
                    "Canvey Island, Essex",
                    "Canvey Island",
                    "Brockley, south-east London",
                    "Brockley",
                    "Tooting Bec",
                    "Princes Risborough, Buckinghamshire",
                    "Princes Risborough",
                    "Aylesbury",
                    "Bicester",
                    "Banbury",
                    "High Wycombe",
                    "Beaconsfield",
                    "Radnage",
                    "Great Missenden",
                    "Paisley, Renfrewshire",
                    "Paisley",
                    "Ayr",
                    "Greenock",
                    "Wemyss Bay",
                    "Henley-on-Thames, Oxfordshire",
                    "Henley-on-Thames",
                    "Henley",
                    "Shiplake",
                    "Twyford",
                    "Lynton and Lynmouth, north Devon",
                    "Lynton and Lynmouth",
                    "Lynton",
                    "Lynmouth",
                    "Barnstaple",
                    "Exeter",
                    "Ilfracombe",
                    "Lynmouth",
                    "Croyde",
                    "Shrewsbury, Shropshire",
                    "Shrewsbury",
                    "Dublin",
                    "Telford",
                    "Wrexham",
                    "Hereford",
                    "Westerham, West Malling and the West Kent Downs",
                    "Westerham",
                    "West Malling",
                    "Oxted",
                    "Maidstone",
                    "Borough Green & Wrotham",
                    "Borough Green",
                    "Wrotham",
                    "Otford",
                    "Chipstead",
                    "Leigh-on-Sea",
                    "Leigh",
                    "Fenchurch Street",
                    "Barking",
                    "West Ham",
                    "South Norwood and Thornton Heath, south London",
                    "South Norwood and Thornton Heath",
                    "South Norwood",
                    "Thornton Heath",
                    "Norwood",
                    "Crystal Palace",
                    "Knighton",
                    "Shrewsbury",
                    "Llandrindod",
                    "Leominster",
                    "Ludlow",
                    "Kington",
                    "Titley",
                    "Old Radnor",
                    "Presteigne",
                    "Northumberland",
                    "Amble",
                    "Alnmouth",
                    "Warkworth",
                    "Alnwick",
                    "Ripley, Derbyshire",
                    "Ripley",
                    "Heanor",
                    "Alfreton",
                    "Barnstaple, Devon",
                    "Barnstaple",
                    "Woolacombe",
                    "Goodleigh",
                    "Conwy",
                    "Betws-y-Coed",
                    "Blaenau Ffestiniog",
                    "Llandudno",
                    "Gwydir",
                    "Winchcombe, Gloucestershire",
                    "Winchcombe",
                    "Sudeley",
                    "Willersey",
                    "Great Yarmouth",
                    "Lowestoft",
                    "Beccles",
                    "Steyning, West Sussex",
                    "Steyning",
                    "Burgess Hill",
                    "Shoreham",
                    "Moretonhampstead and east Dartmoor, Devon",
                    "Moretonhampstead",
                    "Dartmoor",
                    "Newton Abbot",
                    "Teignmouth",
                    "Dunsford",
                    "Chagford",
                    "Drewsteignton",
                    "Dunchideock",
                    "Alston, Cumbria",
                    "Alston",
                    "Langwathby",
                    "Lazonby",
                    "Penrith",
                    "Haltwhistle",
                    "Hexham",
                    "Talkin",
                    "Penrith",
                    "Carlisle",
                    "Brampton",
                    "Hexham",
                    "Glasgow Southside",
                    "Glasgow",
                    "Southside",
                    "Giffnock",
                    "Shawlands",
                    "Abbey Wood, south-east London",
                    "Abbey Wood",
                    "Notting Hill",
                    "Belgravia",
                    "Belmarsh",
                    "Gravesend",
                    "Rochester",
                    "Woolwich",
                    "Thamesmead",
                    "Canary Wharf",
                    "Slaithwaite and the Colne Valley, West Yorkshire",
                    "Slaithwaite",
                    "the Colne Valley",
                    "Solihull, West Midlands",
                    "Solihull",
                    "Farnham, Surrey",
                    "Farnham",
                    "Braunton, Croyde and Woolacombe, Devon",
                    "Braunton",
                    "Croyde",
                    "Woolacombe",
                    "the Nadder valley, Wiltshire",
                    "the Nadder valley",
                    "Wiltshire",
                    "Winterbourne Stoke",
                    "Wylye",
                    "Teffont Magna",
                    "Tisbury",
                    "Salisbury",
                    "Shaftesbury",
                    "Salisbury",
                    "Bath",
                    "Bournemouth",
                    "Barford St Martin",
                    "Hindon",
                    "Jesmond, Newcastle upon Tyne",
                    "Jesmond",
                    "Tynemouth",
                    "Gateshead",
                    "Sunderland",
                    "Killingworth",
                    "Happisburgh, Norfolk",
                    "Happisburgh",
                    "Cromer",
                    "Walsham",
                    "Caister",
                    "Tottenham, north London",
                    "Tottenham",
                    "Chepstow, Monmouthshire",
                    "Chepstow",
                    "Tadcaster, north Yorkshire",
                    "Tadcaster",
                    "Ulleskelf",
                    "Church Fenton",
                    "Soho, central London",
                    "Soho",
                    "Shepherd's Bush",
                    "Melton Mowbray, Leicestershire",
                    "Melton Mowbray",
                    "Eyemouth and St Abbs Head, Berwickshire",
                    "Eyemouth and St Abbs Head",
                    "Eyemouth",
                    "St Abbs Head",
                    "Berwickshire",
                    "Church Stretton and the Shropshire Hills, Shropshire",
                    "Church Stretton",
                    "the Shropshire Hills",
                    "Shropshire",
                    "Wenlock Edge",
                    "Ramsgate, Kent",
                    "Ramsgate",
                    "Thanet",
                    "Sandwich",
                    "Falmouth, Cornwall",
                    "Falmouth",
                    "Holmfirth, West Yorkshire",
                    "Holmfirth",
                    "Brockholes",
                    "Sydenham, south-east London",
                    "Sydenham",
                    "Surbiton",
                    "Pinner",
                    "Sidcup",
                    "Penge",
                    "East Dulwich",
                    "Dulwich",
                    "Pevensey and Pevensey Bay, East Sussex",
                    "Pevensey",
                    "Pevensey Bay",
                    "East Sussex",
                    "Dungeness",
                    "Hailsham",
                    "Wartling",
                    "Herstmonceux",
                    "Tynemouth, Tyne & Wear",
                    "Tynemouth",
                    "Tyne & Wear",
                    "Tyne and Wear",
                    "St Asaph",
                    "Denbighshire",
                    "Rhyl",
                    "Lyme Regis, Dorset",
                    "Lyme Regis",
                    "Axminster",
                    "Weymouth",
                    "Devizes, Wiltshire",
                    "Devizes",
                    "Rowde",
                    "the Forest of Dean, Gloucestershire",
                    "the Forest of Dean",
                    "Ross-on-Wye",
                    "Lydney",
                    "Longhope",
                    "Joyford",
                    "Marlow, Buckinghamshire",
                    "Marlow",
                    "Maidenhead",
                    "Bourne End",
                    "Marlow Bridge",
                    "Barnet, north-west London",
                    "Barnet",
                    "Welwyn",
                    "Hadley",
                    "Hadley Green",
                    "Monken Hadley",
                    "New Barnet",
                    "Whetstone",
                    "Nantwich, Cheshire",
                    "Nantwich",
                    "The Marches",
                    "the Marches",
                    "Welshpool, Powys",
                    "Welshpool",
                    "Dorchester, Dorset",
                    "Dorchester",
                    "Torridge",
                    "SE25",
                    "E11",
                    "Risborough",
                    "Crosthwaite",
                    "Feltham",
                    "St.Leonards",
                    "Warwick",
                    "Thame",
                    "Berinsfield",
                    "Hendford",
                    "Broadwater Farm",
                    "Blackfriars",
                    "Reculver",
                    "Bekonscot",
                    "Rammy",
                    "Man City",
                    "Westend",
                    "the West End",
                    "Heaton Moor",
                    "Ottery St Mary",
                    "Abersoch",
                    "Biddenden",
                    "Dumfries, Dumfries & Galloway",
                    "Dumfries & Galloway",
                    "Dumfries and Galloway",
                    "Dumfries",
                    "Galloway",
                    "Stockton Heath",
                    "Lymm",
                    "Appleton Thorn",
                    "Thelwall",
                    "Grappenhall",
                    "Byker",
                    "Chesil",
                    "Tavistock, Devon",
                    "Tavistock",
                    "Bannockburn",
                    "Northumbria",
                    "Tenby",
                    "Blaenavon",
                    "Boscobel",
                    "Oxleas",
                    "Broadstairs",
                    "Haverfordwest",
                    "Great Torrington",
                    "Torrington",
                    "St Andrews",
                    "Donhead St Andrew",
                    "Brynmawr",
                    "Pollokshields",
                    "Bunbury",
                    "Deauville",
                    "Stromness",
                    "North Shields",
                    "Kennington",
                    "Finsbury Park",
                    "Greenwich",
                    "Bromley",
                    "Buckland Brewer",
                    "Elstree",
                    "Pinewood",
                    "Vauxhall",
                    "Elephant and Castle",
                    "Poundbury",
                    "Kimmeridge",
                    "Walton-on-the-Naze, Essex",
                    "Walton-on-the-Naze",
                    "Walton",
                    "Frinton",
                    #"",
                    #"",

        ]

    known_pubs = [
                  "Anne of Cleves",
                  "Bell Inn",
                  "Blacksmiths Arms",
                  "Black Boys",
                  "Black Lion",
                  "Black Swan",
                  "Boathouse",
                  "Breda Murphy",
                  "Briarbank",
                  "Brig o'Turk",
                  "Burnt Truffle",
                  "Cassons",
                  "Church Street Tavern",
                  "Clockwork Beer Co",
                  "Crab Shed",
                  "Felin Fach Griffin",
                  "Ferry Inn",
                  "Feversham Arms",
                  "Fraiche",
                  "Friday Tap",
                  "Gardeners Arms",
                  "Grayson Unity",
                  "Great Northern Railway Tavern",
                  "Greene Oak",
                  "Gunton Arms",
                  "Harry's Bar",
                  "Iron Bridge",
                  "Jamaica Inn",
                  "Jenny Watts",
                  "Jenny Watts?",
                  "Lamb & Flag",
                  "Masons Arms",
                  "Nutshell",
                  "Ox and Finch",
                  "Pandora Inn",
                  "Pelham Arms",
                  "Pheasant",
                  "Pilot Inn",
                  "Porter & Rye",
                  "Pratts & Payne",
                  "Queens Head",
                  "Red Lion",
                  "Salutation Inn",
                  "Seven Stars",
                  "Shepherd & Dog",
                  "Ship",
                  "Ship Inn",
                  "Sportsman",
                  "Spyglass",
                  "Stagg",
                  "Summat's Brewing",
                  "The Angel",
                  "The Bat and Ball",
                  "The Bell Inn",
                  "The Birds",
                  "The Black Dog",
                  "The Black Rat",
                  "The Boat Inn",
                  "The Borough",
                  "The Bull & Last",
                  "The Butcher's Dog",
                  "The Cap & Collar",
                  "The Cock Tavern",
                  "The Cove House Inn",
                  "the Chain Locker",
                  "The Cricketers",
                  "The Crown",
                  "The Crown Inn",
                  "The Curfew",
                  "The Dove",
                  "The Drayman's Son",
                  "The Embankment",
                  "The Espy",
                  "The Ferry Inn",
                  "The Fox",
                  "The Free Trade,",
                  "The Freemasons",
                  "The George",
                  "The Golden Fleece",
                  "The Griffin",
                  "The Hand & Flowers",
                  "The Harbour Inn",
                  "The Harp",
                  "The Hearth Of The Ram",
                  "The Inn",
                  "The Just Reproach",
                  "The King's Head",
                  "The Kings Arms",
                  "The Lamb",
                  "The Lamb Inn",
                  "The Lewes Arms",
                  "The Lion & Unicorn",
                  "The Lord Nelson",
                  "The Marwood",
                  "The Nook",
                  "The Old Boat House",
                  "The Old Cannon",
                  "The Old Deanery",
                  "The Old Sun Inn",
                  "The One Eyed Rat",
                  "The Pipe and Glass",
                  "The Plume of Feathers",
                  "The Ram",
                  "The Rising Sun",
                  "The Rose",
                  "The Rose & Crown",
                  "The Rose and Crown",
                  "The Royal Oak",
                  "The Running Horses",
                  "The Salisbury",
                  "The Snowdrop",
                  "The Spotted Cow",
                  "The Standard Inn",
                  "The Sun",
                  "The Swan",
                  "The Swan With Two Nicks",
                  "The Thatch",
                  "The Three Tuns",
                  "The Three Horseshoes",
                  "The West House",
                  "The Wheatsheaf",
                  "The White Horse",
                  "The White Lion",
                  "The Whitebrook",
                  "The Willow Tree",
                  "The Woolpack",
                  "Ty Coch",
                  "Water Witch",
                  "West Kirby Tap",
                  "Whippet Inn",
                  "Ypres Castle",
                  "the Angel",
                  "the Anne of Cleves",
                  "the Armoury",
                  "the Assheton Arms",
                  "the Allison Arms",
                  "the Badger",
                  "the Bear",
                  "the Beckford Arms",
                  "the Beehive",
                  "the Bell Inn",
                  "the Black Boys",
                  "the Black Lion",
                  "the Black Rabbit",
                  "the Black Swan",
                  "the Blacksmiths Arms",
                  "the Boat House",
                  "the Bull & Swan",
                  "the Bull and Swan",
                  "the Byre Inn",
                  "the Cluny",
                  "the Coach & Horses",
                  "the Comm Bar",
                  "the Coopers Arms",
                  "the Crab & Lobster",
                  "the Dartmoor Inn",
                  "the Digby Tap",
                  "the Dog & Bell",
                  "the Dog & Muffler",
                  "the Dog and Bell",
                  "the Dog and Muffler",
                  "the Duke of York",
                  "the Eagle + Child",
                  "the Earl of March",
                  "the Errigle Inn",
                  "the Fat Cat",
                  "the Feathers",
                  "the Feversham Arms",
                  "the Finnieston",
                  "the Fleur de Lys",
                  "the Forester",
                  "the Free Trade",
                  "the Gannet",
                  "the Garden House Inn",
                  "the Gardeners Arms",
                  "the Gardeners' Arms",
                  "the George",
                  "the George & Dragon",
                  "the Gipsy Queen",
                  "the Glasshouse Inn",
                  "the Great Northern Railway Tavern",
                  "the Gunton Arms",
                  "the Hare",
                  "the Hole in t'Wall",
                  "the Iron Bridge",
                  "the Jamaica Inn",
                  "the Jenny Watts",
                  "the John Harvey",
                  "the King's Head",
                  "the Lamb",
                  "the Lion Inn",
                  "the Malt Shovel",
                  "the Masons Arms",
                  "the Monico",
                  "the Muddiford Inn",
                  "the New Inn",
                  "the Nobody Inn",
                  "the Noel Arms",
                  "the Nova Scotia",
                  "the Nutshell",
                  "the Old Fire Engine House",
                  "the Old Inn",
                  "the Orange Tree",
                  "the Ostrich in Newland",
                  "the Ox and Finch",
                  "the Pandora Inn",
                  "the Pelham Arms",
                  "the Pheasant",
                  "the Pilot Inn",
                  "the Pink & Lily",
                  "the Pink and Lily",
                  "the Plough",
                  "the Queens Head",
                  "the Ramsbottom Tap",
                  "the Raven",
                  "the Raven Inn",
                  "the Red Fox",
                  "the Red Lion",
                  "the Richmond Arms",
                  "the Rock",
                  "the Rose and Crown",
                  "the Royal Oak",
                  "the Salty Dog",
                  "the Salutation Inn",
                  "the Seven Stars",
                  "the Shepherd & Dog",
                  "the Shibden Mill Inn",
                  "the Ship",
                  "the Ship Inn",
                  "the Southampton Arms",
                  "the Sportsman",
                  "the Spyglass",
                  "the Star",
                  "the Star Inn",
                  "the Strugglers",
                  "the Sun Inn",
                  "the Tap House",
                  "the Thatch",
                  "the Three Tuns",
                  "the Tobie Norris",
                  "the Triangle Inn",
                  "the Tyne Bar",
                  "the Vault",
                  "the Victoria Inn",
                  "the Water Witch",
                  "the Wheatsheaf",
                  "the Whippet Inn",
                  "the White Cross",
                  "the White Hart Hotel",
                  "the Yew Tree Inn",
                  "the Ypres Castle",
                  "the Globe Inn",
                  "the Cavens Arms",
                  "the Jolly Sailors",
                  "The Cornish Arms",
                  "the Pavilion",
                  "the Rifleman's Arms",
                  "the Peterloo",
                  "Peterloo",
                  "Birchsden Arms",
                  "the Birchsden Arms",
                  ]

    known_counties = [
                        "Aberdeenshire",
                        "Anglesey",
                        "Antrim",
                        "Argyll",
                        "Armagh",
                        "Avon",
                        "Ayrshire",
                        "Banffshire",
                        "Bedfordshire",
                        "Berkshire",
                        "Berwickshire",
                        "Brecknockshire",
                        "Buckinghamshire",
                        "Bucks",
                        "Bute",
                        "Caernarfonshire",
                        "Caithness",
                        "Cambridgeshire",
                        "Cardiganshire",
                        "Carmarthenshire",
                        "Ceredigion",
                        "Cheshire",
                        "Clackmannanshire",
                        "Cleveland",
                        "Clwyd",
                        "Conwy",
                        "Cornwall",
                        "County Durham",
                        "Cromartyshire",
                        "Cumberland",
                        "Cumbria",
                        "Denbighshire",
                        "Derbyshire",
                        "Devon",
                        "Dorset",
                        "Dumfries & Galloway",
                        "Dumfries and Galloway",
                        "Dumfriesshire",
                        "Dunbartonshire",
                        "Durham (County Durham)",
                        "Dyfed",
                        "East Lothian",
                        "East Suffolk",
                        "East Sussex",
                        "Elginshire",
                        "Essex",
                        "Fermanagh",
                        "Fife",
                        "Flintshire",
                        "Glamorgan",
                        "Gloucestershire",
                        "Gwent",
                        "Gwynedd",
                        "Hampshire",
                        "Hereford and Worcester",
                        "Herefordshire",
                        "Hertfordshire",
                        "Humberside",
                        "Huntingdon and Peterborough",
                        "Huntingdonshire",
                        "Inverness-shire",
                        "Invernessshire",
                        "Isle of Ely",
                        "Isle of Wight",
                        "Kent",
                        "Kincardineshire",
                        "Kinross-shire",
                        "Kinrossshire",
                        "Kirkcudbrightshire",
                        "Lanarkshire",
                        "Lancashire",
                        "Leicestershire",
                        "Lincolnshire",
                        "Linlithgowshire",
                        "Londonderry",
                        "Merionethshire",
                        "Mid Glamorgan",
                        "Middlesex",
                        "Midlothian",
                        "Monmouthshire",
                        "Montgomeryshire",
                        "Moray",
                        "Moray (Elginshire)",
                        "Nairnshire",
                        "Norfolk",
                        "North Humberside",
                        "North Yorkshire",
                        "Northamptonshire",
                        "Northumberland",
                        "Nottinghamshire",
                        "Orkney",
                        "Oxfordshire",
                        "Peeblesshire",
                        "Pembrokeshire",
                        "Perthshire",
                        "Powys",
                        "Radnorshire",
                        "Renfrewshire",
                        "Ross & Cromarty",
                        "Ross and Cromarty",
                        "Ross-shire",
                        "Rossshire",
                        "Roxburghshire",
                        "Rutland",
                        "Selkirkshire",
                        "Shetland",
                        "Shropshire",
                        "Somerset",
                        "South Glamorgan",
                        "South Humberside",
                        "South Yorkshire",
                        "Staffordshire",
                        "Stirlingshire",
                        "Suffolk",
                        "Surrey",
                        "Sussex",
                        "Sutherland",
                        "Tyne and Wear",
                        "Tyrone",
                        "Warwickshire",
                        "West Glamorgan",
                        "West Lothian",
                        "West Midlands",
                        "West Suffolk",
                        "West Sussex",
                        "West Yorkshire",
                        "Westmorland",
                        "Wigtownshire",
                        "Wiltshire",
                        "Worcestershire",
                        "Yorkshire",
                        ]


    known_people = [
                  "Adam Walker",
                  "Ainslie McCrone",
                  "Alan Bullard",
                  "Alan Winlow",
                  "Alex Woywodt",
                  "Alfie Billsberry",
                  "Alison Binstead",
                  "Alison Churchill",
                  "Alison King",
                  "Alison Neal",
                  "Alison Park",
                  "Alistair Richardson",
                  "Ally Onions",
                  "Amanda Crane",
                  "Amanda Taylor",
                  "Amanda Turner",
                  "Amy Krang",
                  "Andrew Devon",
                  "Andrew Green",
                  "Andy Mainwaring",
                  "Andy and Helen Langton",
                  "Angela Griffiths",
                  "Angela Mitchell",
                  "Angelo Monni",
                  "Ann Thwaite",
                  "Ann Underwood",
                  "Ann-Marie Coyne",
                  "Ann-Marie James",
                  "Anna Dixon",
                  "Anna Inglis",
                  "Anna Nohr",
                  "Anna Telling",
                  "Anne Bryson",
                  "Anne McGoldrick",
                  "Arthur Watts",
                  "Becky Barnes",
                  "Becky Smith",
                  "Bernadette Stokoe",
                  "Beth Oliver",
                  "Bethany Stephenson",
                  "Bill Howard",
                  "Bob Vant",
                  "Calum Chace",
                  "Calum Fraser",
                  "Carol Harvey",
                  "Carol Hayden",
                  "Carol Olivier",
                  "Carol Scott",
                  "Carol Watkinson",
                  "Caroline Anderson",
                  "Caroline Kilgour",
                  "Caroline Leinster",
                  "Caroline Redmond",
                  "Cath Thomas",
                  "Catherine Cameron",
                  "Catherine Lyons",
                  "Catherine Wike",
                  "Charlotte Cornell",
                  "Charlotte House",
                  "Chris Baker",
                  "Chris Bird",
                  "Chris Coates",
                  "Chris Driver",
                  "Chris Hall",
                  "Chris Locke",
                  "Chris Prior",
                  "Christine Eburne",
                  "Christine Elliott",
                  "Christopher Smith",
                  "Clare Griffin",
                  "Clare Stevens",
                  "Clare Tomlinson",
                  "Colin Lloyd",
                  "Dale McDonald",
                  "Dan Andrew",
                  "Dan Cruces",
                  "Dan Whitehead",
                  "Daniel Barnes",
                  "Daniel Butler",
                  "Daniel Frampton",
                  "Danny Watts",
                  "Dave Jelley",
                  "Dave Newman",
                  "Dave Oxford",
                  "Dave Ward",
                  "Davey Payne",
                  "David Anderson",
                  "David Barker",
                  "David Evans",
                  "David Fairley",
                  "David Jones",
                  "David Rees",
                  "David Vanstone",
                  "David Weaver",
                  "Debbie MacCallum",
                  "Deborah Squire",
                  "Derek Brown",
                  "Diederik Smet",
                  "Dom Blower",
                  "Dom Green",
                  "Doug Battersby",
                  "Doug Battersby:",
                  "Dougal Marwick",
                  "Dr Michael Edwards",
                  "Duncan Livingstone",
                  "Dylan Davies",
                  "Elaine Foster",
                  "Eleanor Allen",
                  "Elly Gibson",
                  "Emma Alston",
                  "Emma Halstead",
                  "Emma Leatham",
                  "Emma Soutar",
                  "Emma Taylor",
                  "Emma Whittington",
                  "Emma-Jane Mills",
                  "Faith Dallas",
                  "Fi Hirst",
                  "Finbar Murphy",
                  "Fiona Jones",
                  "Fiona Sims",
                  "Fiona Thompson",
                  "Fiona Wilton",
                  "Frances Middleton",
                  "Frank Gent",
                  "Fraser David",
                  "Gareth Crichton",
                  "Gareth Wynne",
                  "Garreth Cummins",
                  "Gaye Barns",
                  "Ged Hanley",
                  "Geoff Hardwicke",
                  "Geoff Kelly",
                  "Geraldine Blake",
                  "Gill Cairns",
                  "Gillian Hustwick",
                  "Gillian Lodge",
                  "Gilly Williams",
                  "Gladys Arlidge",
                  "Graham Currie",
                  "Gregory Hayman",
                  "Halen Lemberger",
                  "Hannah Hislop",
                  "Hannah Verdier",
                  "Hans Peters",
                  "Harry Benyon",
                  "Heather Ramsay",
                  "Helen Dobson",
                  "Helen Mugnaioni",
                  "Helene Brandon",
                  "Holly Park",
                  "Howard Phillis",
                  "Hugh Closs",
                  "Hugh Flouch",
                  "Iain Johnston",
                  "Ian Cholmondeley",
                  "Ian Hall",
                  "Ian McCourt",
                  "Ian Morris",
                  "Ian Strachan",
                  "Isabel Janicki",
                  "Ivor Rowlands",
                  "Jackie Crossman",
                  "Jackie Neil",
                  "Jackie Savage",
                  "Jacqueline Reed",
                  "James Douglass",
                  "James Murray",
                  "James Styles",
                  "Jamie Macdonald",
                  "Jamie Merrill",
                  "Jan Cadwallader",
                  "Jan Holden",
                  "Jane Ackroyd",
                  "Jane Bennett-Powell",
                  "Jane Duran",
                  "Jane Holmes",
                  "Jane Hunter",
                  "Jane Marter",
                  "Jane Parsons",
                  "Jane Redshaw",
                  "Janet Abbott",
                  "Janet Perks",
                  "Janet Sharp",
                  "Jean Grocott",
                  "Jean Rogers",
                  "Jean Shirley",
                  "Jeanette Moorcroft",
                  "Jeanne Donaldson",
                  "Jenny Chamberlain",
                  "Jenny Dalrymple",
                  "Jenny Simpson",
                  "Jeremy Friend-Smith",
                  "Jeremy Johnston",
                  "Jess Brown",
                  "Jill Carr",
                  "Jill Zago",
                  "Jill ZagoSara Dixon",
                  "Jill and Geoff Grote",
                  "Jim Blanden",
                  "Jim Sheeran",
                  "Jo Little",
                  "Jo Tierney",
                  "Joan Gilham",
                  "Joan Halstead",
                  "Joanna Jeffery",
                  "Joanna Law",
                  "Joanne Spiro",
                  "John Allison",
                  "John Anderson",
                  "John Bell",
                  "John Cullinane",
                  "John Horn",
                  "John Kennedy",
                  "John Palfrey",
                  "John Parfett",
                  "John Rhodes",
                  "John Stone",
                  "John Whitelegg",
                  "John Worrall",
                  "Jon Parker",
                  "Jon Pelluet",
                  "Jonathan Thomas",
                  "Joseph Stewart",
                  "Josephine Rutherfoord",
                  "Josie Huxtable",
                  "Joy Lintoff",
                  "Jude Nixon",
                  "Judy Wills",
                  "Julia Ingall",
                  "Julie Hudson",
                  "Julie Marrow",
                  "Juliet Stott",
                  "Justine Wingate",
                  "Karen Bamforth",
                  "Karen Lesley Rodenburg",
                  "Kate Beardon",
                  "Kate Kneale",
                  "Kate Rhys",
                  "Kath Clark",
                  "Kathie Prince",
                  "Kathryn Dickens",
                  "Kathryn Reilly",
                  "Kathryn Stewart",
                  "Katie Cohen",
                  "Kelly Innes",
                  "Kerry Burton",
                  "Kevin O'Sullivan",
                  "Kiran Sidhu",
                  "Laura Coates",
                  "Laura Cooper",
                  "Laura Martin",
                  "Laura Neuveglise",
                  "Laurence Knight",
                  "Leanne Pemberton",
                  "Lesley Aers",
                  "Lesley Mills",
                  "Libby Hamilton",
                  "Linda Clare",
                  "Linda Zubairi",
                  "Lindsay Finnie",
                  "Lionel Playford",
                  "Lisa Francis",
                  "Liz Holden",
                  "Liz Wheatley",
                  "Lois Phelps",
                  "Lorna Carsley",
                  "Louise Martell",
                  "Lucy Roy",
                  "Lucy Smith",
                  "Lyn Holmes",
                  "Malcolm Airs",
                  "Malcolm Carpenter",
                  "Mandy Edwards",
                  "Margaret Tennant",
                  "Margaret Whitehead",
                  "Marian Head",
                  "Marion Currie",
                  "Marjorie Ashdown",
                  "Mark Mckay",
                  "Mark Say",
                  "Martin Lander",
                  "Martin Thompson",
                  "Mary Buxton",
                  "Mary O'Driscoll",
                  "Matt McMinn",
                  "Matthew Hook",
                  "Matthew Martin",
                  "Maurice Flintoff",
                  "Megan and Will Clark",
                  "Michael Brown",
                  "Michael Hallewell",
                  "Michael Stocks",
                  "Michaela Ball",
                  "Michelle Whitworth",
                  "Mike Carran",
                  "Mike Graham",
                  "Mike Neary",
                  "Mike Newman",
                  "Mili Acharya",
                  "Moira Brewer",
                  "Morag Michael",
                  "Nader Fekri",
                  "Natalie D",
                  "Natalie Davies",
                  "Nathalie Quigley",
                  "Neil Murphy",
                  "Niall Macalister Hall",
                  "Nick Cooper",
                  "Nick Godfrey",
                  "Nick Greenall",
                  "Nigel Davies (no relation)",
                  "Nigel Hunt",
                  "Nigel Kemp",
                  "Nigel Peacock",
                  "Nigel Spooner",
                  "Nog Clark",
                  "Nolan Dalrymple",
                  "Oliver Baker",
                  "Pam Wallace",
                  "Pamela Glanville",
                  "Pamela Richmond",
                  "Patricia Sauer",
                  "Patrick Newbound",
                  "Patrick Troughton",
                  "Patta Tolputt",
                  "Paul Clarke",
                  "Paul Davies",
                  "Pauline Porteus",
                  "Pete Dalby",
                  "Peter Baxendale",
                  "Peter Dougherty",
                  "Peter Hames",
                  "Peter Keam",
                  "Peter Marshall",
                  "Peter Roland",
                  "Peter Taylor",
                  "Phil Buckingham",
                  "Phil Clark",
                  "Phil Griffiths",
                  "Phil King",
                  "Phil Law",
                  "Phil Lea",
                  "Phil Rowson",
                  "Phil Topham",
                  "Philip Runeckles",
                  "Philipa Coughlan",
                  "Pippa Boss",
                  "Rachael Salt",
                  "Rachael Tout",
                  "Ray Bleazard",
                  "Ray Lowry",
                  "Rebecca Knowles",
                  "Rene Wyndham",
                  "Rhonda Stevens",
                  "Ric Johnson",
                  "Richard Ashcroft",
                  "Richard Berry",
                  "Richard Berry:",
                  "Richard Styles",
                  "Richard Ward",
                  "Rick Williams",
                  "Rob Ballantyne",
                  "Rob Lambourn",
                  "Robert Downing",
                  "Robin Milner-Gulland",
                  "Rodney Tinson",
                  "Roger Gilles",
                  "Roger Protz",
                  "Rory Collins",
                  "Ros Brear",
                  "Rose Jenkins",
                  "Rosina Northcott",
                  "Roy Mackenzie",
                  "Roy and Hazel Marchant",
                  "Ruby Downs",
                  "Ruby Lescott",
                  "Ruth Gilliam-Hill",
                  "Ruth Kennedy-Green",
                  "Ruud Jansen Venneboer",
                  "Sam Harvey",
                  "Sam Llewellyn",
                  "Sandra Mills",
                  "Sara Coleman",
                  "Sara Dixon",
                  "Sarah Bellis",
                  "Sarah Carter",
                  "Sarah Jackson",
                  "Sarah Thompson",
                  "Sarah Wilks",
                  "Sarah Williams",
                  "Scott Pickard",
                  "Sean Hare",
                  "Selina Fellows",
                  "Sharon Dalziel",
                  "Sharon Paul",
                  "Sheena Ramsay",
                  "Sheila Cowley",
                  "Simon Bridge",
                  "Simon Clark",
                  "Simon Read",
                  "Simon Ward",
                  "Simon Wootton",
                  "Sophie Marfell",
                  "Stella Smith",
                  "Steph Culpin",
                  "Stephen Adamson",
                  "Stephen Matthews",
                  "Stephen Rubins",
                  "Steve Bentley",
                  "Steve Chinn",
                  "Steve Crelley",
                  "Steve Dixon-Smith",
                  "Steve Ratcliffe",
                  "Steve Sankey",
                  "Stuart Dagger",
                  "Stuart Reid",
                  "Sue Brown",
                  "Susan Burrett",
                  "Susan Moore",
                  "Susie Kearley",
                  "Suszi Saunders",
                  "Sylvia Lewis",
                  "Tania Williams",
                  "Taslima Shahjahan",
                  "The Reynolds family",
                  "Tim Smith",
                  "Timothy Gorman",
                  "Tom Cutler",
                  "Tom Handysides",
                  "Tom Vining",
                  "Tony Hutchinson",
                  "Tony Reed",
                  "Tracey Priest",
                  "Trisha Eaton",
                  "Valerie Kemp",
                  "Vera Chapman Browne",
                  "Vicky Wade",
                  "Virginia Brown",
                  "Wendy Williams",
                  "Will Mott",
                  "Will Weaver",
                  "Gaboogle",
                  "Victoria Paige",
                  "Maureen Smyth",
                  "Murray Sutherland",
                  "Gillian Brydson",
                  "Sarah Denne",
                  "Peter Fox",
                  "Anna de Pass",
                  "Thea Roper",

                  #Special cases
                  #Journalists
                  "Grace Dent",
                  "Marina O'Loughlin",
                  "Clement Scott",
                  #MPs
                  "Owen Paterson",
                  "Mhairi Black",
                  "Jeremy Hunt",
                  "Mark Reckless"#, 
                  ]


    #London Underground tube lines, and other light rail systems...
    known_tube_lines = [
        "Bakerloo line",
        "Central line",
        "Circle line",
        "District line",
        "Hammersmith & City line",
        "Hammersmith and City line",
        "Jubilee line",
        "Metropolitan line",
        "Northern line",
        "Piccadilly line",
        "Victoria line",
        "Waterloo & City line",
        "Waterloo and City line",
        "Elizabeth line",
        "Crossrail",
        "Overground",
        "London Overground",
        "DLR",
        "Docklands Light Railway",
        "Tyne Metro",
        "Tramlink",
        #assume these short/one word references are to the tube line too
        "Bakerloo",
        "Hammersmith & City",
        "Hammersmith and City",
        "Waterloo & City",
        "Waterloo and City",
        "Metro",
        ]


    property_subjects = [["2019_10_11.txt", ["St Leonards-on-Sea, East Sussex", "St Leonards"]],
                         ["2019_10_04.txt", ["Croydon, south London", "Croydon"]],
                         ["2019_09_27.txt", ["New Ash Green, Kent", "New Ash Green"]],
                         ["2019_09_20.txt", ["Buxton, Derbyshire", "Buxton"]],
                         ["2019_09_13.txt", ["Lancaster, Lancashire", "Lancaster"]],
                         ["2019_09_06.txt", ["Ormeau, Belfast", "Ormeau"]],
                         ["2019_08_30.txt", ["Ventnor, Isle of Wight", "Ventnor"]],
                         ["2019_08_23.txt", ["West Kirby, Merseyside", "West Kirby"]],
                         ["2019_08_16.txt", ["Helmsley, North Yorkshire", "Helmsley"]],
                         ["2019_08_09.txt", ["Chichester, West Sussex", "Chichester"]],
                         ["2019_08_02.txt", ["Bermondsey, south-east London", "Bermondsey"]],
                         ["2019_07_26.txt", ["Cardigan, Ceredigion", "Cardigan"]],
                         ["2019_07_19.txt", ["Hemel Hempstead, Hertfordshire", "Hemel Hempstead"]],
                         ["2019_07_12.txt", ["Whitley Bay, Tyne and Wear", "Whitley Bay"]],
                         ["2019_07_05.txt", ["Thurso and Dunnet Bay, Caithness", "Thurso and Dunnet Bay"]],
                         ["2019_06_28.txt", ["Brighton, East Sussex:", "Brighton"]],
                         ["2019_06_21.txt", ["Grimsby and Cleethorpes, Lincolnshire", "Grimsby and Cleethorpes"]],
                         ["2019_06_14.txt", ["Kendal, Cumbria", "Kendal"]],
                         ["2019_06_07.txt", ["Bognor Regis, West Sussex", "Bognor Regis"]],
                         ["2019_05_31.txt", ["Didsbury, south Manchester", "Didsbury"]],
                         ["2019_05_17.txt", ["Hertford, Hertfordshire", "Hertford"]],
                         ["2019_05_10.txt", ["Hornsey, north London", "Hornsey"]],
                         ["2019_05_03.txt", ["Oswestry, Shropshire", "Oswestry"]],
                         ["2019_04_26.txt", ["Ripon, North Yorkshire", "Ripon"]],
                         ["2019_04_19.txt", ["Ely, Cambridgeshire", "Ely"]],
                         ["2019_04_05.txt", ["Whitstable, Kent", "Whitstable"]],
                         ["2019_03_29.txt", ["Brecon, Powys", "Brecon"]],
                         ["2019_03_22.txt", ["Winchester, Hampshire", "Winchester"]],
                         ["2019_03_08.txt", ["Brentford, west London", "Brentford"]],
                         ["2019_03_01.txt", ["Stirling", "Stirling"]],
                         ["2019_02_22.txt", ["Cromer, Norfolk", "Cromer"]],
                         ["2019_02_15.txt", ["Bedford", "Bedford"]],
                         ["2019_02_08.txt", ["Clitheroe, Lancashire", "Clitheroe"]],
                         ["2019_02_01.txt", ["Anglesey/Ynys Môn, Wales", "Anglesey/Ynys Môn"]],
                         ["2019_01_25.txt", ["Sherborne, Dorset", "Sherborne"]],###
                         ["2019_01_18.txt", ["Somers Town and Euston, north London", "Somers Town"]],
                         ["2019_01_11.txt", ["King's Lynn, Norfolk", "King's Lynn"]],
                         ["2019_01_04.txt", ["Warwick, Warwickshire", "Warwick"]],
                         ["2018_12_28.txt", ["Great Malvern and the Malvern hills", "Great Malvern"]],
                         ["2018_12_14.txt", ["Littlehampton, West Sussex", "Littlehampton"]],
                         ["2018_12_07.txt", ["Bangor, County Down", "Bangor"]],
                         ["2018_11_30.txt", ["Chester, Cheshire", "Chester"]],
                         ["2018_11_23.txt", ["Gospel Oak, north London", "Gospel Oak"]],
                         ["2018_11_16.txt", ["Portobello, Edinburgh", "Portobello"]],
                         ["2018_11_09.txt", ["Colchester, Essex", "Colchester"]],
                         ["2018_11_02.txt", ["Wimborne Minster", "Wimborne Minster"]],
                         ["2018_10_26.txt", ["Worcester", "Worcester"]],
                         ["2018_10_12.txt", ["Abergavenny, Monmouthshire", "Abergavenny"]],
                         ["2018_10_05.txt", ["Deal, Kent", "Deal"]],
                         ["2018_09_28.txt", ["Grange-Over-Sands, Cumbria", "Grange-Over-Sands"]],
                         ["2018_09_21.txt", ["Leytonstone", "Leytonstone"]],
                         ["2018_09_14.txt", ["Lewes, East Sussex", "Lewes"]],
                         ["2018_09_07.txt", ["Southwold, Suffolk", "Southwold"]],  ###
                         ["2018_08_24.txt", ["Callander and the Trossachs", "Callander"]],
                         ["2018_08_17.txt", ["Openshaw", "Openshaw"]],
                         ["2018_08_03.txt", ["Bury St Edmunds, Suffolk", "Bury"]],
                         ["2018_07_27.txt", ["Weston-super-Mare, Somerset", "Weston-super-Mare"]],
                         ["2018_07_20.txt", ["Ramsbottom, Greater Manchester", "Ramsbottom"]],
                         ["2018_07_13.txt", ["Halifax, West Yorkshire", "Halifax"]],
                         ["2018_07_06.txt", ["Lampeter, Ceredigion", "Lampeter"]],
                         ["2018_06_29.txt", ["Surrey Quays, London", "Surrey Quays"]],
                         ["2018_06_22.txt", ["St Andrews", "St Andrews"]],
                         ["2018_06_15.txt", ["Ipswich, Suffolk", "Ipswich"]],
                         ["2018_06_08.txt", ["Ouseburn, Newcastle upon Tyne", "Ouseburn"]],
                         ["2018_06_01.txt", ["Dorking, Surrey", "Dorking"]],
                         ["2018_05_11.txt", ["Truro, Cornwall", "Truro"]],
                         ["2018_04_20.txt", ["Stockport, Greater Manchester", "Stockport"]],
                         ["2018_04_13.txt", ["King's Cross, London", "King's Cross"]],
                         ["2018_04_06.txt", ["Tenterden, Kent", "Tenterden"]],
                         ["2018_03_30.txt", ["Warrington, Cheshire", "Warrington"]],
                         ["2018_03_23.txt", ["Eastbourne, East Sussex", "Eastbourne"]],
                         ["2018_03_16.txt", ["Spalding, Lincolnshire", "Spalding"]],
                         ["2018_03_02.txt", ["Exeter, Devon", "Exeter"]],
                         ["2018_02_23.txt", ["Hebden Bridge, West Yorks", "Hebden Bridge"]],
                         ["2018_02_09.txt", ["Deptford, south-east London", "Deptford"]],
                         ["2018_02_02.txt", ["Stroud, Gloucestershire", "Stroud"]],
                         ["2018_01_26.txt", ["Beverley, east Yorkshire", "Beverley"]],
                         ["2018_01_19.txt", ["Finnieston, Glasgow", "Finnieston"]],
                         ["2018_01_12.txt", ["Louth, Lincolnshire", "Louth"]],
                         ["2018_01_05.txt", ["Lichfield, Staffordshire", "Lichfield"]],
                         ["2017_12_29.txt", ["Romford, east London", "Romford"]],
                         ["2017_12_22.txt", ["Bexhill-on-Sea, East Sussex", "Bexhill-on-Sea"]],
                         ["2017_12_15.txt", ["Pwllheli", "Pwllheli"]],
                         ["2017_12_08.txt", ["Kelso, Roxburghshire", "Kelso"]],
                         ["2017_12_01.txt", ["Whitby, North Yorkshire", "Whitby"]],
                         ["2017_11_24.txt", ["Hereford", "Hereford"]],
                         ["2017_11_17.txt", ["Stamford, Lincolnshire", "Stamford"]],
                         ["2017_11_10.txt", ["Frome, Somerset", "Frome"]],
                         ["2017_11_03.txt", ["Windsor & Eton, Berkshire", "Windsor & Eton"]],
                         ["2017_10_27.txt", ["Lincoln", "Lincoln"]],
                         ["2017_10_20.txt", ["Berwick-upon-Tweed, Northumberland", "Berwick-upon-Tweed"]],
                         ["2017_10_06.txt", ["Dollis Hill, north-west London", "Dollis Hill"]],
                         ["2017_10_01.txt", ["Arundel, West Sussex", "Arundel"]],
                         ["2017_09_29.txt", ["Boscastle, Cornwall", "Boscastle"]],
                         ["2017_09_22.txt", ["Kintyre peninsula, Argyll and Bute", "Kintyre"]],
                         ["2017_09_08.txt", ["Diss, Norfolk", "Diss, Norfolk"]],
                         ["2017_08_25.txt", ["Kingston upon Hull, Yorkshire", "Kingston upon Hull"]],
                         ["2017_08_17.txt", ["Rochester, Kent", "Rochester"]],
                         ["2017_08_11.txt", ["Preston, Lancashire", "Preston"]],
                         ["2017_08_04.txt", ["Herne Bay, Kent", "Herne Bay"]],
                         ### property_subjects (AUTO-GENERATED) ###
                         ["2017_07_28.txt", ["Brockley, south-east London", "Brockley"]],
                         ["2017_07_21.txt", ["Canvey Island, Essex", "Canvey Island"]],
                         ["2017_07_14.txt", ["Ballycastle, County Antrim", "Ballycastle"]],
                         ["2017_07_07.txt", ["Hove, East Sussex", "Hove"]],
                         ["2017_06_30.txt", ["Aylsham, Norfolk", "Aylsham"]],
                         ["2017_06_23.txt", ["Cambridge", "Cambridge"]],
                         ["2017_06_16.txt", ["Helensburgh, Argyll & Bute", "Helensburgh"]],
                         ["2017_06_09.txt", ["Beaconsfield, Bucks", "Beaconsfield"]],
                         ["2017_06_02.txt", ["Dorchester-on-Thames, Oxfordshire", "Dorchester-on-Thames"]],
                         ["2017_05_26.txt", ["Ilford, east London", "Ilford"]],
                         ["2017_05_19.txt", ["Rothbury, Northumberland", "Rothbury"]],
                         ["2017_05_12.txt", ["Thetford, Norfolk", "Thetford"]],
                         ["2017_05_05.txt", ["Blaenafon, Gwent", "Blaenafon"]],
                         ["2017_04_21.txt", ["the Isle of Portland, Dorset", "the Isle of Portland"]],
                         ["2017_04_14.txt", ["Crediton, Devon", "Crediton"]],
                         ["2017_04_07.txt", ["Kirkcaldy, Fife", "Kirkcaldy"]],
                         ["2017_04_01.txt", ["Framplington, Suffolk", "Framplington"]],
                         ["2017_03_24.txt", ["Petworth and Pulborough, West Sussex", "Petworth and Pulborough"]],
                         ["2017_03_17.txt", ["Rhayader & the Elan valley, Powys", "Rhayader"]],
                         ["2017_03_03.txt", ["Hither Green, London", "Hither Green"]],
                         ["2017_02_24.txt", ["the Torridge valley, Devon", "the Torridge valley"]],
                         ["2017_02_17.txt", ["Bishop's Castle, Shropshire", "Bishop's Castle"]],
                         ["2017_02_10.txt", ["Kirkwall and Orkney", "Kirkwall and Orkney"]],
                         ["2017_02_03.txt", ["Ashbourne, Derbyshire", "Ashbourne"]],
                         ["2017_01_27.txt", ["Newport, Isle of Wight", "Newport"]],
                         ["2017_01_20.txt", ["Scarborough, North Yorkshire", "Scarborough"]],
                         ["2017_01_13.txt", ["Streatham, south-west London", "Streatham"]],
                         ["2017_01_06.txt", ["Durham, County Durham", "Durham"]],
                         ["2016_12_16.txt", ["Fishguard and Newport, Pembrokeshire", "Fishguard and Newport"]],
                         ["2016_12_09.txt", ["Dover, Kent", "Dover"]],
                         ["2016_12_02.txt", ["Rye, East Sussex", "Rye"]],
                         ["2016_11_25.txt", ["St Albans", "St Albans"]],
                         ["2016_11_18.txt", ["Harringay, north London", "Harringay"]],
                         ["2016_11_11.txt", ["Stranraer and the Rhinns, Dumfries and Galloway", "Stranraer"]],
                         ["2016_11_04.txt", ["Ottery St Mary, Devon", "Ottery St Mary"]],
                         ["2016_10_28.txt", ["Worthing, West Sussex", "Worthing"]],
                         ["2016_10_21.txt", ["Hotwells, Bristol", "Hotwells"]],
                         ["2016_10_14.txt", ["Perth, Perthshire", "Perth"]],
                         ["2016_10_07.txt", ["Canterbury, Kent", "Canterbury"]],
                         ["2016_09_30.txt", ["Aberaeron, Ceredigion", "Aberaeron"]],
                         ["2016_09_23.txt", ["Lambeth, London", "Lambeth"]],
                         ["2016_09_16.txt", ["Luton, Bedfordshire", "Luton"]],
                         ["2016_09_09.txt", ["Bowness and Windermere", "Bowness and Windermere"]],
                         ["2016_09_02.txt", ["Saltaire", "Saltaire"]],
                         ["2016_08_19.txt", ["Lowestoft, Suffolk", "Lowestoft"]],
                         ["2016_08_12.txt", ["Lanark", "Lanark"]],
                         ["2016_08_05.txt", ["Okehampton, Devon", "Okehampton"]],
                         ["2016_07_29.txt", ["Monmouth and the lower Wye valley", "Monmouth"]],
                         ["2016_07_22.txt", ["Abingdon, Oxfordshire", "Abingdon"]],
                         ["2016_07_15.txt", ["Plumstead, south-east London", "Plumstead"]],
                         ["2016_07_08.txt", ["Princes Risborough, Buckinghamshire", "Princes Risborough"]],
                         ["2016_06_24.txt", ["Paisley, Renfrewshire", "Paisley"]],
                         ["2016_06_17.txt", ["Henley-on-Thames, Oxfordshire", "Henley"]],
                         ["2016_06_10.txt", ["Lynton and Lynmouth, north Devon", "Lynton and Lynmouth"]],
                         ["2016_06_03.txt", ["Shrewsbury, Shropshire", "Shrewsbury"]],
                         ["2016_05_27.txt", ["Westerham, West Malling and the West Kent Downs", "Westerham"]],
                         ["2016_05_20.txt", ["Leigh-on-Sea", "Leigh"]],
                         ["2016_05_13.txt", ["South Norwood and Thornton Heath, south London", "South Norwood"]],
                         ["2016_05_06.txt", ["The Marches", "The Marches"]],
                         ["2016_04_29.txt", ["Northumberland", "Northumberland"]],
                         ["2016_04_22.txt", ["Ripley, Derbyshire", "Ripley"]],
                         ["2016_04_15.txt", ["Barnstaple, Devon", "Barnstaple"]],
                         ["2016_04_08.txt", ["Llanrwst, Conwy", "Llanrwst"]],
                         ["2016_04_01.txt", ["Winchcombe, Gloucestershire", "Winchcombe"]],
                         ["2016_03_25.txt", ["Great Yarmouth", "Great Yarmouth"]],
                         ["2016_03_18.txt", ["Steyning, West Sussex", "Steyning"]],
                         ["2016_03_04.txt", ["Moretonhampstead and east Dartmoor, Devon", "Moretonhampstead"]],
                         ["2016_02_26.txt", ["Alston, Cumbria", "Alston"]],
                         ["2016_02_19.txt", ["Glasgow Southside", "Glasgow Southside"]],
                         ["2016_02_12.txt", ["Abbey Wood, south-east London", "Abbey Wood"]],
                         ["2016_02_05.txt", ["Slaithwaite and the Colne Valley, West Yorkshire", "Slaithwaite"]],
                         ["2016_01_29.txt", ["Solihull, West Midlands", "Solihull"]],
                         ["2016_01_22.txt", ["Farnham, Surrey", "Farnham"]],
                         ["2016_01_15.txt", ["Braunton, Croyde and Woolacombe, Devon", "Braunton"]],
                         ["2016_01_01.txt", ["the Nadder valley, Wiltshire", "the Nadder valley"]],
                         ["2015_12_18.txt", ["Jesmond, Newcastle upon Tyne", "Jesmond"]],
                         ["2015_12_11.txt", ["Happisburgh, Norfolk", "Happisburgh"]],
                         ["2015_12_04.txt", ["Tottenham, north London", "Tottenham"]],
                         ["2015_11_27.txt", ["Chepstow, Monmouthshire", "Chepstow"]],
                         ["2015_11_20.txt", ["Tadcaster, north Yorkshire", "Tadcaster"]],
                         ["2015_11_13.txt", ["Soho, central London", "Soho"]],
                         ["2015_11_06.txt", ["Melton Mowbray, Leicestershire", "Melton Mowbray"]],
                         ["2015_10_30.txt", ["Eyemouth and St Abbs Head, Berwickshire", "Eyemouth"]],
                         ["2015_10_23.txt", ["Church Stretton and the Shropshire Hills, Shropshire", "Church Stretton"]],
                         ["2015_10_16.txt", ["Ramsgate, Kent", "Ramsgate"]],
                         ["2015_10_09.txt", ["Falmouth, Cornwall", "Falmouth"]],
                         ["2015_10_02.txt", ["Holmfirth, West Yorkshire", "Holmfirth"]],
                         ["2015_09_25.txt", ["Sydenham, south-east London", "Sydenham"]],
                         ["2015_09_18.txt", ["Pevensey and Pevensey Bay, East Sussex", "Pevensey"]],
                         ["2015_09_11.txt", ["Tynemouth, Tyne & Wear", "Tynemouth"]],
                         ["2015_09_04.txt", ["St Asaph, Denbighshire", "St Asaph"]],
                         ["2015_08_28.txt", ["Lyme Regis, Dorset", "Lyme Regis"]],
                         ["2015_08_21.txt", ["Devizes, Wiltshire", "Devizes"]],
                         ["2015_08_14.txt", ["the Forest of Dean, Gloucestershire", "the Forest of Dean"]],
                         ["2015_08_07.txt", ["Marlow, Buckinghamshire", "Marlow"]],
                         ["2015_07_31.txt", ["Barnet, north-west London", "Barnet"]],
                         ["2015_07_24.txt", ["Nantwich, Cheshire", "Nantwich"]],
                         ["2015_07_17.txt", ["The Marches", "the Marches"]],
                         ["2015_07_10.txt", ["Welshpool, Powys", "Welshpool"]],
                         ["2015_07_03.txt", ["Dorchester, Dorset", "Dorchester"]],
                         ["2019_10_18.txt", ["Dumfries, Dumfries & Galloway", "Dumfries"]],
                         ["2019_10_26.txt", ["Tavistock, Devon", "Tavistock"]],
                         ["2019_11_02.txt", ["Walton-on-the-Naze, Essex", "Walton-on-the-Naze"]],
                         #["", ["", ""]],
                         #["", ["", ""]],
                         ]

    locals = ["Lancastrians", "Buxtonians", "Cardigans", "Northumbrians"]

    rivers = ["Thames", "Itchen", "Usk", "Beane", "Mersey", "Teifi",
              "Lagan", "Ouse", "Avon", "Severn", "Arun", "Fleet", "Welland",
              "Tyne", "Ouseburn", "Deptford Creek", "Clyde", "Forth",
              "Tweed", "Esk", "Ribble", "Humber", "Medway", "Brent",
              "Nadder", "Wye", "Wharfe", "Tavy", "Lea", "Dee", "Colne",
              "Taw"]

    for subj in property_subjects:
        subj = u"%s" % subj
        if file == subj[0]:
            if string.find(text, subj[1][0]) > -1:
                text = string.replace(text, subj[1][0], u"[MAINPLACE]")
            elif string.find(text, subj[1][1]) > -1:
                text = string.replace(text, subj[1][1], u"[MAINPLACE]")

    for local in locals:
        local = u"%s" % local
        if string.find(text, local) > -1:
            text = string.replace(text, local, u"[LOCALS]")

    for place in known_places:
        place = u"%s" % place
        if string.find(text, place) > -1:
            text = string.replace(text, place, u"[PLACE]")

    for pub in known_pubs:
        pub = u"%s" % pub
        if string.find(text, pub) > -1:
            text = string.replace(text, pub, u"[PUB]")

    for person in known_people:
        person = u"%s" % person
        if string.find(text, person) > -1:
            text = string.replace(text, person, u"[PERSON]")

    for county in known_counties:
        county = u"%s" % county
        if string.find(text, county) > -1:
            text = string.replace(text, county, u"[COUNTY]")

    for rail_line in known_tube_lines:
        rail_line = u"%s" % rail_line
        if string.find(text, rail_line) > -1:
            text = string.replace(text, rail_line, u"[RAILWAY]")

    #have this last so it doesn't mess up any other substitutions...
    #Too many short river names.            
    for river in rivers:
        river = u"%s" % river
        if string.find(text, river) > -1:
            text = string.replace(text, river, u"[RIVER]")

    return u"%s" % text


def make_douglas_adams_quotes(VERBOSE=0):
    """Does our substitutions on our file of Douglas Adams quotes.
    Writes output to by_section_final/da_quotes.txt"""

    print "\nMaking Douglas Adams quotes file"

    if VERBOSE == 1:
        print "\n making Douglas Adams quotes file"

    dafn = "da_quotes.txt"
    input_dir1 = os.path.join(os.getcwd(), "raw")
    input_dir2 = os.path.join(os.getcwd(), "by_section_final")

    input_file = io.open(os.path.join(input_dir1, "da_quotes.txt"), "r", encoding="UTF-8")
    output_file = io.open(os.path.join(input_dir2, dafn), "w", encoding="UTF-8")

    text = input_file.read()
    text = da_subs.do_subs(text)

    output_file.write(text)

    output_file.close()
    
    if VERBOSE == 1:
        print "\n wrote file '%s'.\n\n" % os.path.join(input_dir2, dwfn)

    if VERBOSE == 1:
        print "\n Finished creating Douglas Adams quotes.\n\n"
    print "\nFinished creating Douglas Adams quotes.\n\n"


def make_discworld_quotes(VERBOSE=0):
    """does our substitutions on our local version of The Pratchett Quote File.
    Writes output to by_section_final/discworld_quotes.txt"""

    print "\nMaking discworld quotes file"

    if VERBOSE == 1:
        print "\n making discworld quotes file"


    dwfn = "discworld_quotes.txt"
    input_dir1 = os.path.join(os.getcwd(), "raw")
    input_dir2 = os.path.join(os.getcwd(), "by_section_final")

    input_file = io.open(os.path.join(input_dir1, "pqf2.txt"), "r", encoding="UTF-8")
    output_file = io.open(os.path.join(input_dir2, dwfn), "w", encoding="UTF-8")

    text = input_file.read()
    text = pqf_subs.do_subs(text)
    output_file.write(text)

    output_file.close()
    
    if VERBOSE == 1:
        print "\n wrote file '%s'.\n\n" % os.path.join(input_dir2, dwfn)

    if VERBOSE == 1:
        print "\n Finished creating discworld quotes.\n\n"
    print "\nFinished creating discworld quotes.\n\n"


def make_annals_quotes(VERBOSE=0):
    """does our substitutions on our local version of The Annals of the Parrigues by Emily Short.
    Writes output to by_section_final/annals_quotes.txt"""

    print "\nMaking Annals of the Parrigues quotes file"

    if VERBOSE == 1:
        print "\n making Annals of the Parrigues quotes file"

    aotpfn = "annals_quotes.txt"
    input_dir1 = os.path.join(os.getcwd(), "raw")
    input_dir2 = os.path.join(os.getcwd(), "by_section_final")

    #input_file = io.open(os.path.join(input_dir1, "annals.txt"), "r", encoding="UTF-8")
    input_file = open(os.path.join(input_dir1, "annals.txt"), "r")

    output_file = io.open(os.path.join(input_dir2, aotpfn), "w", encoding="UTF-8")

    text = input_file.read()
    text = annals_subs.do_subs(text)

    output_file.write(text.decode("UTF-8"))

    output_file.close()
    
    if VERBOSE == 1:
        print "\n wrote file '%s'.\n\n" % os.path.join(input_dir2, aotpfn)

    if VERBOSE == 1:
        print "\n Finished creating Annals of the Parrigues quotes.\n\n"
    print "\nFinished creating Annals of the Parrigues quotes.\n\n"


def make_revelations_quotes(VERBOSE=0):
    """Does our substitutions on our file of the Book of Revelations quotes.
    Writes output to by_section_final/rev_quotes.txt"""

    print "\nMaking Book of Revelations file"

    if VERBOSE == 1:
        print "\n making Book of Revelations file"

    revfn = "rev_quotes.txt"
    input_dir1 = os.path.join(os.getcwd(), "raw")
    input_dir2 = os.path.join(os.getcwd(), "by_section_final")

    input_file = io.open(os.path.join(input_dir1, "revelation.txt"), "r", encoding="UTF-8")
    output_file = io.open(os.path.join(input_dir2, revfn), "w", encoding="UTF-8")

    text = input_file.read()
    text = rev_subs.do_subs(text)

    output_file.write(text)

    output_file.close()
    
    if VERBOSE == 1:
        print "\n wrote file '%s'.\n\n" % os.path.join(input_dir2, revfn)

    if VERBOSE == 1:
        print "\n Finished creating Book of Revelations file.\n\n"
    print "\nFinished creating Book of Revelations file.\n\n"




def make_random_quotes(VERBOSE=0):
    """takes quotes from various places in pycorpora and makes up random quotes files - so we have stuff which
isn't explicitly from the Guardian.

Sources include:
    technology_quotes   (Anti_Machine_Propaganda/Machines_As_Tools_Propaganda/Machine_As_Masters_Propaganda)
    oprahQuotes         (Words of wisdom by Oprah Winfrey)
    proverbs            (A list of proverbs sourced from http://tww.id.au/proverbs/proverbs.html)
    Westworld_quotes    (quotes from theh TV show Westworld)
    us_president_quotes (quotes from US presidents)
"""

    DEBUG = 0
    #uncomment for extra debugging info...
    #DEBUG = 1

    print "\nMaking random quotes file"

    if VERBOSE == 1:
        print "\n making random quotes file"
    randomfn = "random_quotes.txt"
    input_dir1 = os.path.join(os.getcwd(), "raw")
    input_dir2 = os.path.join(os.getcwd(), "by_section_final")
    random_outfile1 = io.open(os.path.join(input_dir1, randomfn), "w", encoding="UTF-8")
    random_outfile2 = io.open(os.path.join(input_dir2, randomfn), "w", encoding="UTF-8")

    randomquotes = []

    sources = [
        pycorpora.words.literature.technology_quotes['Anti_Machine_Propaganda']['Source_1']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Anti_Machine_Propaganda']['Source_2']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Machines_As_Tools_Propaganda']['Source_1']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Machines_As_Tools_Propaganda']['Source_2']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_1']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_2']['Paragraphs'],
        pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_3']['Paragraphs'],
        pycorpora.words.oprah_quotes["oprahQuotes"],    #Words of wisdom by Oprah Winfrey
        #pycorpora.words.proverbs["proverbs"],           #A list of proverbs sourced from http://tww.id.au/proverbs/proverbs.html
        pycorpora.words.proverbs["proverbs"][0]['Friendship'],
        pycorpora.words.proverbs["proverbs"][1]['Love'],
        pycorpora.words.proverbs["proverbs"][2]['Relationships'],
        pycorpora.words.proverbs["proverbs"][3]['Life'],
        pycorpora.words.proverbs["proverbs"][4]['Health & Food'],
        pycorpora.words.proverbs["proverbs"][5]['Conversation'],
        pycorpora.words.proverbs["proverbs"][6]['Wisdom'],
        pycorpora.words.proverbs["proverbs"][7]['Work'],
        pycorpora.words.proverbs["proverbs"][8]['Animal related'],
        pycorpora.words.proverbs["proverbs"][9]['Rural'],
        pycorpora.words.proverbs["proverbs"][10]['Growth'],
        pycorpora.words.proverbs["proverbs"][11]['Money'],
        pycorpora.words.proverbs["proverbs"][12]['Business'],
        pycorpora.words.proverbs["proverbs"][13]['Fools'],
        #pycorpora.film-tv.Westworld_quotes              #quotes from Westworld
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Peter Abernathy'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Hector Escaton'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][4]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][5]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][6]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Karl Strand'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][4]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][5]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][6]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][7]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][8]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][9]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][10]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][11]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][12]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][13]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Clementine PennyFeather'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['William'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['William'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][4]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][5]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][6]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][7]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][8]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][9]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][10]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][11]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][12]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][13]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][14]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][15]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][0]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][1]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][2]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][3]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][4]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][5]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][6]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][7]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][8]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][9]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][10]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][11]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][12]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][13]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][14]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][15]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][16]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][17]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][18]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][19]['quote'],
        pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Elsie King'][0]['quote'],
        #pycorpora.words.us_president_quotes             #quotes from US presidents
        pycorpora.words.us_president_quotes["data"][0]["quotes"],
        pycorpora.words.us_president_quotes["data"][1]["quotes"],
        pycorpora.words.us_president_quotes["data"][2]["quotes"],
        pycorpora.words.us_president_quotes["data"][3]["quotes"],
        pycorpora.words.us_president_quotes["data"][4]["quotes"],
        pycorpora.words.us_president_quotes["data"][5]["quotes"],
        pycorpora.words.us_president_quotes["data"][6]["quotes"],
        pycorpora.words.us_president_quotes["data"][7]["quotes"],
        pycorpora.words.us_president_quotes["data"][8]["quotes"],
        pycorpora.words.us_president_quotes["data"][9]["quotes"],
        pycorpora.words.us_president_quotes["data"][10]["quotes"],
        pycorpora.words.us_president_quotes["data"][11]["quotes"],
        pycorpora.words.us_president_quotes["data"][12]["quotes"],
        pycorpora.words.us_president_quotes["data"][13]["quotes"],
        pycorpora.words.us_president_quotes["data"][14]["quotes"],
        pycorpora.words.us_president_quotes["data"][15]["quotes"],
        pycorpora.words.us_president_quotes["data"][16]["quotes"],
        pycorpora.words.us_president_quotes["data"][17]["quotes"],
        pycorpora.words.us_president_quotes["data"][18]["quotes"],
        pycorpora.words.us_president_quotes["data"][19]["quotes"],
        pycorpora.words.us_president_quotes["data"][20]["quotes"],
        pycorpora.words.us_president_quotes["data"][21]["quotes"],
        pycorpora.words.us_president_quotes["data"][22]["quotes"],
        pycorpora.words.us_president_quotes["data"][23]["quotes"],
        pycorpora.words.us_president_quotes["data"][24]["quotes"],
        pycorpora.words.oprah_quotes["oprahQuotes"],    #Make Oprah Winfrey quotes that bit more common...
        ]

    sourcenames = [
        '''pycorpora.words.literature.technology_quotes['Anti_Machine_Propaganda']['Source_1']''',
        '''pycorpora.words.literature.technology_quotes['Anti_Machine_Propaganda']['Source_2']''',
        '''pycorpora.words.literature.technology_quotes['Machines_As_Tools_Propaganda']['Source_1']''',
        '''pycorpora.words.literature.technology_quotes['Machines_As_Tools_Propaganda']['Source_2']''',
        '''pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_1']''',
        '''pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_2']''',
        '''pycorpora.words.literature.technology_quotes['Machine_As_Masters_Propaganda']['Source_3']''',
        'pycorpora.words.oprah_quotes["oprahQuotes"]',
        #'pycorpora.words.proverbs["proverbs"]',
        '''pycorpora.words.proverbs["proverbs"][0]['Friendship']''',
        '''pycorpora.words.proverbs["proverbs"][1]['Love']''',
        '''pycorpora.words.proverbs["proverbs"][2]Relationships']''',
        '''pycorpora.words.proverbs["proverbs"][3]['Life']''',
        '''pycorpora.words.proverbs["proverbs"][4]['Health & Food']''',
        '''pycorpora.words.proverbs["proverbs"][5]['Conversation']''',
        '''pycorpora.words.proverbs["proverbs"][6]['Wisdom']''',
        '''pycorpora.words.proverbs["proverbs"][7]['Work']''',
        '''pycorpora.words.proverbs["proverbs"][8]['Animal related']''',
        '''pycorpora.words.proverbs["proverbs"][9]['Rural']''',
        '''pycorpora.words.proverbs["proverbs"][10]['Growth']''',
        '''pycorpora.words.proverbs["proverbs"][11]['Money']''',
        '''pycorpora.words.proverbs["proverbs"][12]['Business']''',
        '''pycorpora.words.proverbs["proverbs"][13]['Fools']''',
        #pycorpora.film-tv.Westworld_quotes              #quotes from Westworld
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Peter Abernathy'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Hector Escaton'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][4]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][5]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Man in Black'][6]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Bernard Lowe'][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Karl Strand'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][4]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][5]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][6]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][7]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][8]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][9]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][10]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][11]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][12]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Maeve Millay'][13]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Clementine PennyFeather'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['William'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['William'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']["Theodore 'Teddy' Flood"][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][4]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][5]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][6]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][7]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][8]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][9]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][10]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][11]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][12]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][13]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][14]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dolores Abernathy'][15]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][0]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][1]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][2]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][3]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][4]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][5]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][6]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][7]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][8]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][9]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][10]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][11]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][12]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][13]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][14]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][15]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][16]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][17]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][18]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Dr. Robert Ford'][19]['quote']''',
        '''pycorpora.get_file('film-tv','Westworld_quotes')['main']['characters']['Elsie King'][0]['quote']''',
        #'pycorpora.words.us_president_quotes'
        '''pycorpora.words.us_president_quotes["data"][0]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][1]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][2]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][3]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][4]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][5]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][6]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][7]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][8]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][9]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][10]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][11]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][12]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][13]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][14]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][15]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][16]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][17]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][18]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][19]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][20]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][21]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][22]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][23]["quotes"]''',
        '''pycorpora.words.us_president_quotes["data"][24]["quotes"]''',
        'pycorpora.words.oprah_quotes["oprahQuotes"]',
        ]

    for s in range(0, len(sources)):
        if VERBOSE == 1:
            print "\n\t adding quotes from '%s'" % sourcenames[s]
        else:
            print ".",
        if type(sources[s]) in [ListType,TupleType]:#SPAM
            for q in sources[s]:
                if DEBUG == 1:
                    if len(q) <3:
                        print "!!!ERROR!!!"
                        print "\t s: '%s'" % s
                        print "\t sourcenames[s]: '%s'" % sourcenames[s]
                        sys.exit(-1)
                if q not in randomquotes:
                    if q[-1] not in [".", "!", "?"]:
                        q = "%s." % q
                    randomquotes.append(q)
                if VERBOSE == 1:
                    print ".",
        else:
            if DEBUG == 1:
                if len(sources[s]) <3:
                    print "!!!ERROR!!!"
                    print "\t s: '%s'" % s
                    print "\t sourcenames[s]: '%s'" % sourcenames[s]
                    sys.exit(-1)
            if sources[s] not in randomquotes:
                if sources[s][-1] not in [".", "!", "?"]:
                    sources[s] = "%s." % sources[s]
                randomquotes.append(sources[s])
            if VERBOSE == 1:
                print ".",

    randomquotes.sort()
    for q in randomquotes:
        if DEBUG == 1:
            print "\n %s" % q.encode("ascii", "ignore")
            #print "\n %s" % q
            
        #random_outfile.write(u"%s\n" % q)
        random_outfile1.write(u"%s\n" % q)
        random_outfile2.write(u"%s\n" % q)

    #random_outfile.close()
    random_outfile1.close()
    random_outfile2.close()

    if VERBOSE == 1:
        print "\n Finished creating random quotes.\n\n"
    print "\nFinished creating random quotes.\n\n"




def make_sections(VERBOSE=0):
    """Does our substitutions on the source files downloaded from the Guardian's Let's Move To... articles...

Also divides them into sections, so we can combine content on similar subjects."""

    divider_text = ["What's going for it",
                    "The case against",
                    "Well connected",
                    "Schools",
                    "Hang out at",
                    "Where to buy",
                    "Bargain of the week",
                    "From the streets",
                    "Do you have a",
                    "Do you live in",
                    "Live in",
                    "Live on",
                    "Comments"
                    ]

    startdir = os.getcwd()
    input_dir = os.path.join(os.getcwd(), "raw")
    output_dir = os.path.join(os.getcwd(), "by_section")
    output_dir_final = os.path.join(os.getcwd(), "by_section_final")

    os.chdir(input_dir)
    input_files = glob.glob("2*.txt")
    input_files.sort()
    os.chdir(startdir)

    count = 0

    for file in input_files:
        if VERBOSE == 1:
            print "\nProcessing file '%s'" % file
        else:
            print ".",
        count = count +1
        linecount = 0
        infile = io.open(os.path.join(input_dir, file), "r", encoding="utf-8").readlines()
        this_sect = "intro"
        this_sect_text = ""
        for line in infile:
            for sect in divider_text:
                if string.find(line, sect) > -1:
                    if VERBOSE == 1:
                        print "\t FOUND SECTION '%s'" % sect
                    else:
                        print ".",
                    bit = string.lower(this_sect)
                    bit = string.replace(bit, " ", "_")
                    bit = string.replace(bit, "'", "")
                    infile_prefix, infile_suffix = string.split(file, ".")
                    outfn = "%s_%s.txt" % (bit, infile_prefix)
                    #outfile = open(os.path.join(output_dir, outfn), "w")
                    outfile = io.open(os.path.join(output_dir, outfn), "w", encoding="utf-8")
                    #for l in this_sect_text:
                    #    outfile.write("%s\n" % this_sect_text)
                    outfile.write(u"%s\n" % this_sect_text)
                    outfile.close()
                    if VERBOSE == 1:
                        print "\t wrote file '%s'" % os.path.join(output_dir, outfn)
                    else:
                        print ".",

                    #outfile2 = open(os.path.join(output_dir_final, outfn), "w")
                    outfile2 = io.open(os.path.join(output_dir_final, outfn), "w", encoding="utf-8")
                    this_sect_text_new = modify_section(this_sect_text, file)
                    #for l in this_sect_text:
                    #    outfile.write("%s\n" % this_sect_text)
                    outfile2.write(u"%s\n" % this_sect_text_new)
                    #outfile2.write("%s\n" % this_sect_text_new.encode("UTF-8"))
                    outfile2.close()
                    if VERBOSE == 1:
                        print "\t wrote file '%s'" % os.path.join(output_dir_final, outfn) 
                    else:
                        print ".",

                    outfn3 = os.path.join(output_dir_final, "_%s_ALL.txt" % bit)
                    #outfile3 = open(outfn3, "a")
                    outfile3 = io.open(outfn3, "a", encoding="utf-8")
                    outfile3.write(u"%s\n" % this_sect_text_new)
                    outfile3.close()
                    if VERBOSE == 1:
                        print "\t wrote file '%s'" % outfn3 
                    else:
                        print ".",

                    linecount = 0
                    this_sect = sect
                    this_sect_text = ""
                else:
                    pass
            linecount = linecount + 1
            if linecount < 2:
                #ignore section headers - except for those few...
                if sect in ["Do you live in", "Live in", "Live on"]:
                    this_sect_text = "%s%s" % (this_sect_text, line)
                else:
                    this_sect_text = ""
            else:
                this_sect_text = "%s%s" % (this_sect_text, line)

        #make sure we get the last section...
        if sect in ["Do you live in", "Live in", "Live on", "Comments"]:
            bit = string.lower(this_sect)
            bit = string.replace(bit, " ", "_")
            bit = string.replace(bit, "'", "")
            infile_prefix, infile_suffix = string.split(file, ".")
            outfn = "%s_%s.txt" % (bit, infile_prefix)
            #outfile = open(os.path.join(output_dir, outfn), "w")
            outfile = io.open(os.path.join(output_dir, outfn), "w", encoding="utf-8")
            outfile.write(u"%s\n" % this_sect_text)
            outfile.close()
            if VERBOSE == 1:
                print "\t wrote file '%s'" % os.path.join(output_dir, outfn)
            else:
                print ".",
            #outfile2 = open(os.path.join(output_dir_final, outfn), "w")
            outfile2 = io.open(os.path.join(output_dir_final, outfn), "w", encoding="utf-8")
            this_sect_text_new = modify_section(this_sect_text, file)
            outfile2.write(u"%s\n" % this_sect_text_new)
            outfile2.close()
            if VERBOSE == 1:
                print "\t wrote file '%s'" % os.path.join(output_dir_final, outfn) 
            else:
                print ".",
            if sect == "Comments":
                outfn3 = os.path.join(output_dir_final, "_%s_ALL.txt" % bit)
                #outfile3 = open(outfn3, "a")
                outfile3 = io.open(outfn3, "a", encoding="utf-8")
                outfile3.write(u"%s\n" % this_sect_text_new)
                outfile3.close()
                if VERBOSE == 1:
                    print "\t wrote file '%s'" % outfn3 
                else:
                    print ".",

    print
    print "DONE"
    print "Processed %s files" % count
    print

if __name__ == "__main__":
    #do the substitutions on the smaller files
    make_random_quotes(VERBOSE)
    make_discworld_quotes(VERBOSE)
    make_douglas_adams_quotes(VERBOSE)
    make_annals_quotes(VERBOSE)
    make_revelations_quotes(VERBOSE)
    #do the main, property-related ones
    make_sections(VERBOSE)

